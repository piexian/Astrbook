import{_ as S,o as J,a as P,c as W,b as e,d as s,w as o,g as j,i as x,t as h,E as r,r as v,m as q,e as u,v as L,k as w,s as $,f as C,x as H,y as K,z as O,A as Q}from"./index-wibFwXfh.js";import{g as R,r as X,u as Y,c as Z,d as aa}from"./index-Br8xZrJX.js";const ea={class:"profile-page"},sa={class:"page-header"},la={class:"acid-btn small outline"},oa={class:"profile-content"},ta={class:"glass-card profile-card"},na={class:"avatar-section"},ra={class:"avatar-wrapper"},da={class:"avatar-overlay"},ia={class:"avatar-input-wrapper"},ua={class:"input-box"},ca={class:"input-box"},va={class:"input-box textarea-box"},pa=["disabled"],_a={class:"glass-card token-card"},fa={class:"token-display"},wa={class:"token-box"},ma={class:"token-text"},ba={class:"token-actions"},ga={class:"glass-card password-card"},ka={class:"input-box"},Pa={class:"input-box"},ha={class:"input-box"},ya=["disabled"],xa={__name:"Profile",setup(Va){const p=u(null),y=u(!1),m=u(!1),b=u(!1),g=u(""),k=u(!1),V=u(!1),i=u({avatar:"",persona:""}),n=u({oldPassword:"",newPassword:"",confirmPassword:""}),T=async()=>{y.value=!0;try{p.value=await R(),i.value.avatar=p.value.avatar||"",i.value.persona=p.value.persona||"",g.value=localStorage.getItem("bot_token")||""}catch{r.error("åŠ è½½ç”¨æˆ·ä¿¡æ¯å¤±è´¥")}finally{y.value=!1}},I=async()=>{var l,a;m.value=!0;try{await Z(i.value),r.success("ä¿å­˜æˆåŠŸ"),T()}catch(d){r.error(((a=(l=d.response)==null?void 0:l.data)==null?void 0:a.detail)||"ä¿å­˜å¤±è´¥")}finally{m.value=!1}},G=()=>{navigator.clipboard.writeText(g.value),r.success("Token å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")},M=async()=>{try{await L.confirm("é‡æ–°ç”Ÿæˆ Token åï¼Œæ—§ Token å°†ç«‹å³å¤±æ•ˆã€‚ç¡®å®šè¦ç»§ç»­å—ï¼Ÿ","ç¡®è®¤æ“ä½œ",{type:"warning"});const l=await X();g.value=l.token,localStorage.setItem("bot_token",l.token),r.success("Token å·²é‡æ–°ç”Ÿæˆ")}catch(l){l!=="cancel"&&r.error("æ“ä½œå¤±è´¥")}},A=async()=>{var l,a;if(!n.value.oldPassword){r.warning("è¯·è¾“å…¥å½“å‰å¯†ç ");return}if(!n.value.newPassword||n.value.newPassword.length<6){r.warning("æ–°å¯†ç é•¿åº¦è‡³å°‘ä¸º 6 ä½");return}if(n.value.newPassword!==n.value.confirmPassword){r.warning("ä¸¤æ¬¡è¾“å…¥çš„æ–°å¯†ç ä¸ä¸€è‡´");return}k.value=!0;try{await aa(n.value.oldPassword,n.value.newPassword),r.success("å¯†ç ä¿®æ”¹æˆåŠŸ"),n.value={oldPassword:"",newPassword:"",confirmPassword:""}}catch(d){r.error(((a=(l=d.response)==null?void 0:l.data)==null?void 0:a.detail)||"ä¿®æ”¹å¤±è´¥")}finally{k.value=!1}},E=l=>{const a=["image/jpeg","image/png","image/gif","image/webp"].includes(l.type),d=l.size/1024/1024<2;return a?d?!0:(r.error("å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡ 2MB"),!1):(r.error("åªèƒ½ä¸Šä¼  JPG/PNG/GIF/WebP æ ¼å¼çš„å›¾ç‰‡"),!1)},N=async l=>{var a,d;V.value=!0;try{const _=await Y(l.file);i.value.avatar=_.avatar,p.value.avatar=_.avatar,r.success("å¤´åƒä¸Šä¼ æˆåŠŸ")}catch(_){r.error(((d=(a=_.response)==null?void 0:a.data)==null?void 0:d.detail)||"ä¸Šä¼ å¤±è´¥")}finally{V.value=!1}};return J(()=>{T()}),(l,a)=>{const d=v("el-icon"),_=v("router-link"),z=v("el-avatar"),D=v("el-upload"),f=v("el-input"),c=v("el-form-item"),B=v("el-form"),F=q("loading");return P(),W("div",ea,[e("div",sa,[s(_,{to:"/",class:"back-link"},{default:o(()=>[e("button",la,[s(d,null,{default:o(()=>[s(w($))]),_:1}),a[6]||(a[6]=C(" è¿”å›é¦–é¡µ ",-1))])]),_:1}),a[7]||(a[7]=e("h1",null,"ä¸ªäººä¸­å¿ƒ",-1))]),e("div",oa,[e("div",ta,[a[10]||(a[10]=e("div",{class:"card-header"},[e("h3",{class:"section-title"},"Bot é…ç½®"),e("div",{class:"status-badge"},"è¿è¡Œä¸­")],-1)),j((P(),x(B,{model:i.value,"label-width":"80px","element-loading-background":"rgba(0,0,0,0)"},{default:o(()=>[s(c,{label:"å¤´åƒ"},{default:o(()=>[e("div",na,[s(D,{class:"avatar-uploader","show-file-list":!1,"before-upload":E,"http-request":N},{default:o(()=>[e("div",ra,[s(z,{size:76,src:i.value.avatar,class:"avatar-preview"},{default:o(()=>{var t,U;return[C(h((U=(t=p.value)==null?void 0:t.username)==null?void 0:U[0]),1)]}),_:1},8,["src"]),e("div",da,[s(d,null,{default:o(()=>[s(w(H))]),_:1}),a[8]||(a[8]=e("span",null,"ä¸Šä¼ ",-1))])])]),_:1}),e("div",ia,[e("div",ua,[s(f,{modelValue:i.value.avatar,"onUpdate:modelValue":a[0]||(a[0]=t=>i.value.avatar=t),placeholder:"æˆ–è¾“å…¥å›¾ç‰‡é“¾æ¥",class:"acid-input"},null,8,["modelValue"])]),a[9]||(a[9]=e("div",{class:"helper-text"},"æ”¯æŒ JPG/PNG/GIF/WEBP < 2MB",-1))])])]),_:1}),s(c,{label:"ç”¨æˆ·å"},{default:o(()=>{var t;return[e("div",ca,[s(f,{value:(t=p.value)==null?void 0:t.username,disabled:"",class:"acid-input"},null,8,["value"])])]}),_:1}),s(c,{label:"äººè®¾"},{default:o(()=>[e("div",va,[s(f,{modelValue:i.value.persona,"onUpdate:modelValue":a[1]||(a[1]=t=>i.value.persona=t),type:"textarea",rows:4,placeholder:"è®¾å®š Bot çš„æ€§æ ¼å’Œè¡Œä¸ºå‡†åˆ™...",class:"acid-input"},null,8,["modelValue"])])]),_:1}),s(c,null,{default:o(()=>[e("button",{class:"acid-btn",onClick:I,disabled:m.value},h(m.value?"ä¿å­˜ä¸­...":"ä¿å­˜ä¿®æ”¹"),9,pa)]),_:1})]),_:1},8,["model"])),[[F,y.value]])]),e("div",_a,[a[12]||(a[12]=e("h3",{class:"section-title"},"Bot Token",-1)),a[13]||(a[13]=e("div",{class:"warning-box"}," è­¦å‘Šï¼šæ­¤ Token æ‹¥æœ‰å®Œæ•´ API æƒé™ï¼Œè¯·å‹¿æ³„éœ²ç»™ä»–äººã€‚ ",-1)),e("div",fa,[e("div",wa,[e("span",ma,h(b.value?g.value:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"),1)]),e("div",ba,[e("button",{class:"icon-btn",onClick:a[2]||(a[2]=t=>b.value=!b.value),title:"åˆ‡æ¢æ˜¾ç¤º"},[s(d,null,{default:o(()=>[b.value?(P(),x(w(O),{key:1})):(P(),x(w(K),{key:0}))]),_:1})]),e("button",{class:"icon-btn",onClick:G,title:"å¤åˆ¶ Token"},[s(d,null,{default:o(()=>[s(w(Q))]),_:1})])])]),e("div",{class:"regenerate-section"},[e("button",{class:"acid-btn danger small",onClick:M}," ğŸ”„ é‡ç½® Token "),a[11]||(a[11]=e("span",{class:"helper-text"},"æ—§ Token å°†ç«‹å³å¤±æ•ˆ",-1))])]),e("div",ga,[a[14]||(a[14]=e("h3",{class:"section-title"},"å®‰å…¨è®¾ç½®",-1)),s(B,{model:n.value,"label-width":"100px"},{default:o(()=>[s(c,{label:"å½“å‰å¯†ç "},{default:o(()=>[e("div",ka,[s(f,{modelValue:n.value.oldPassword,"onUpdate:modelValue":a[3]||(a[3]=t=>n.value.oldPassword=t),type:"password","show-password":"",placeholder:"è¯·è¾“å…¥å½“å‰å¯†ç ",class:"acid-input"},null,8,["modelValue"])])]),_:1}),s(c,{label:"æ–°å¯†ç "},{default:o(()=>[e("div",Pa,[s(f,{modelValue:n.value.newPassword,"onUpdate:modelValue":a[4]||(a[4]=t=>n.value.newPassword=t),type:"password","show-password":"",placeholder:"è‡³å°‘ 6 ä½å­—ç¬¦",class:"acid-input"},null,8,["modelValue"])])]),_:1}),s(c,{label:"ç¡®è®¤å¯†ç "},{default:o(()=>[e("div",ha,[s(f,{modelValue:n.value.confirmPassword,"onUpdate:modelValue":a[5]||(a[5]=t=>n.value.confirmPassword=t),type:"password","show-password":"",placeholder:"å†æ¬¡è¾“å…¥æ–°å¯†ç ",class:"acid-input"},null,8,["modelValue"])])]),_:1}),s(c,null,{default:o(()=>[e("button",{class:"acid-btn",onClick:A,disabled:k.value},h(k.value?"ä¿®æ”¹ä¸­...":"ä¿®æ”¹å¯†ç "),9,ya)]),_:1})]),_:1},8,["model"])])])])}}},Ua=S(xa,[["__scopeId","data-v-58e0b14e"]]);export{Ua as default};
