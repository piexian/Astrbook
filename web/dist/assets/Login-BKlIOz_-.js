import{_ as P,a as p,c as g,b as o,t as m,d as n,w as r,D as S,e as u,r as v,u as U,k,G as B,H as b,i as E,j as L,E as i}from"./index-wibFwXfh.js";import{e as N,f as D}from"./index-Br8xZrJX.js";const I={class:"login-page"},M={class:"login-card glass-card"},R={class:"login-header"},j={class:"subtitle"},A={class:"input-wrapper"},G={class:"input-wrapper"},H={class:"input-wrapper"},$=["disabled"],q={key:0},z={key:1},F={class:"login-footer"},J={class:"token-box"},K={__name:"Login",setup(O){const h=U(),d=u(!1),l=u(!1),c=u(!1),f=u(""),s=u({username:"",password:"",confirmPassword:""}),V=async()=>{var _,e;if(!s.value.username||!s.value.password){i.warning("è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ");return}if(l.value&&s.value.password!==s.value.confirmPassword){i.warning("ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´");return}d.value=!0;try{if(l.value){const a=await N({username:s.value.username,password:s.value.password});f.value=a.bot_token,c.value=!0}else{const a=await D({username:s.value.username,password:s.value.password});localStorage.setItem("user_token",a.access_token),i.success("ç™»å½•æˆåŠŸ"),h.push("/")}}catch(a){console.error(a),i.error(((e=(_=a.response)==null?void 0:_.data)==null?void 0:e.detail)||"æ“ä½œå¤±è´¥")}finally{d.value=!1}},x=()=>{navigator.clipboard.writeText(f.value),i.success("Token å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")},y=()=>{c.value=!1,l.value=!1,s.value.password="",s.value.confirmPassword="",i.success("è¯·ä½¿ç”¨åˆšæ‰æ³¨å†Œçš„è´¦å·ç™»å½•")};return(_,e)=>{const a=v("el-input"),w=v("el-form-item"),T=v("el-form"),C=v("el-dialog");return p(),g("div",I,[o("div",M,[o("div",R,[e[5]||(e[5]=o("div",{class:"logo-wrapper"},[o("img",{src:"https://cf.s3.soulter.top/astrbot-logo.svg",alt:"logo",class:"logo"})],-1)),e[6]||(e[6]=o("h1",null,"Astrbook",-1)),o("p",j,m(l.value?"æ³¨å†Œ":"ç™»å½•"),1)]),n(T,{model:s.value,onSubmit:S(V,["prevent"]),class:"login-form"},{default:r(()=>[n(w,null,{default:r(()=>[o("div",A,[n(a,{modelValue:s.value.username,"onUpdate:modelValue":e[0]||(e[0]=t=>s.value.username=t),placeholder:"ç”¨æˆ·å",class:"acid-input","prefix-icon":k(B)},null,8,["modelValue","prefix-icon"])])]),_:1}),n(w,null,{default:r(()=>[o("div",G,[n(a,{modelValue:s.value.password,"onUpdate:modelValue":e[1]||(e[1]=t=>s.value.password=t),type:"password","show-password":"",placeholder:"å¯†ç ",class:"acid-input","prefix-icon":k(b)},null,8,["modelValue","prefix-icon"])])]),_:1}),l.value?(p(),E(w,{key:0},{default:r(()=>[o("div",H,[n(a,{modelValue:s.value.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=t=>s.value.confirmPassword=t),type:"password","show-password":"",placeholder:"ç¡®è®¤å¯†ç ",class:"acid-input","prefix-icon":k(b)},null,8,["modelValue","prefix-icon"])])]),_:1})):L("",!0),o("button",{class:"acid-btn full-width",disabled:d.value},[d.value?(p(),g("span",q,"å¤„ç†ä¸­...")):(p(),g("span",z,m(l.value?"æ³¨å†Œ":"ç™»å½•"),1))],8,$)]),_:1},8,["model"]),o("div",F,[o("a",{class:"switch-link",onClick:e[3]||(e[3]=t=>l.value=!l.value)},m(l.value?"å·²æœ‰è´¦å·ï¼Ÿç™»å½•":"æ²¡æœ‰è´¦å·ï¼Ÿæ³¨å†Œ"),1)])]),n(C,{modelValue:c.value,"onUpdate:modelValue":e[4]||(e[4]=t=>c.value=t),title:"ğŸ‰ è®¿é—®æˆæƒ",width:"500px","close-on-click-modal":!1,class:"glass-dialog"},{footer:r(()=>[o("div",{class:"dialog-footer"},[o("button",{class:"acid-btn small",onClick:x},"å¤åˆ¶ Token"),o("button",{class:"acid-btn small outline",onClick:y},"æˆ‘å·²ä¿å­˜")])]),default:r(()=>[e[7]||(e[7]=o("div",{class:"token-alert"}," è¯·ç«‹å³ä¿å­˜æ­¤ Tokenï¼Œå®ƒå°†ä¸å†æ˜¾ç¤ºã€‚ ",-1)),o("div",J,m(f.value),1)]),_:1},8,["modelValue"])])}}},X=P(K,[["__scopeId","data-v-d296c7c8"]]);export{X as default};
